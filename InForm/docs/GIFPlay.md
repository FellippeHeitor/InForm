# Animated GIF Decoder

***By Zom-B*** ([QB64-PE Wiki](https://qb64phoenix.com/qb64wiki/index.php/GIF_Images))

***Adapted for use with InForm's PictureBox controls by @FellippeHeitor***

***Fixed, refactored and enhanced by @a740g***

## Usage instructions

Your form must contain a PictureBox control that'll serve as a container for
the GIF file you'll load with this library.

In the **External modules section** of the .bas file generated by InForm,
`$INCLUDE` both `GIFPlay.bi` and `GIFPlay.bas`. The first must come before the
line that includes `InForm.ui` and the second must come after that, as in
the sample below:

```vb
': External modules: --------------------------------
'$INCLUDE:'InForm\extensions\GIFPlay.bi'
'$INCLUDE:'InForm\InForm.ui'
'$INCLUDE:'InForm\xp.uitheme'
'$INCLUDE:'gifplaySample.frm'
'$INCLUDE:'InForm\extensions\GIFPlay.bm'
```

## API

```vb
FUNCTION GIF_Open%% (ID AS LONG, fileName AS STRING)
```

GIF_Open is a function that takes a PictureBox control ID and a GIF file name and returns True if loading the animation is successful.

```vb
FUNCTION GIF_GetTotalFrames~& (ID AS LONG)
```

GIF_GetTotalFrames returns the total number of frames in a loaded gif. If not an animated GIF, returns 1.

```vb
SUB GIF_Update(ID AS LONG)
```

GIF_Update must be called from within the __UI_BeforeUpdateDisplay event. That's where the frames will be updated in your PictureBox control.

```vb
FUNCTION GIF_IsPlaying%% (ID AS LONG)
```

Returns True is the PictureBox control contains a GIF that's currently being played.

```vb
SUB GIF_Play(ID AS LONG), SUB GIF_Pause(ID AS LONG), SUB GIF_Stop(ID AS LONGD)
```

Starts, pauses or stops playback of a GIF file loaded into the specified PictureBox control.

```vb
SUB GIF_Close(ID AS LONG)
```

Closes the GIF file loaded in the specified PictureBox control and frees the memory used by the frame data buffer attached to it.

```vb
FUNCTION GIF_GetGeight~% (ID AS LONG)
```

Returns the height of the GIF in pixels.

```vb
FUNCTION GIF_GetWidth~% (ID AS LONG)
```

Returns the width of the GIF in pixels.

```vb
SUB GIF_HideOverlay (ID AS LONG)
```

Hides the **GIF** overlay image when the GIF is not playing or paused.
